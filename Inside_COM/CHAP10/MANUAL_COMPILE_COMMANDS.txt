# [2020-01-28] VC6 SP6+MsSDK2003 build command line sample.
# midl (required by both client & server)
midl /Oicf /h iface.h /iid guids.c /proxy proxy.c /dlldata dlldata.c server.idl

# Proxy.dll
cl /c /MTd /Zi /Od /DWIN32 /D_WIN32_WINNT=0x0501 /DREGISTER_PROXY_DLL guids.c proxy.c
cl /c /MTd /Zi /Od /DWIN32 /D_WIN32_WINNT=0x0501 /DREGISTER_PROXY_DLL /P dlldata.c &&  copy /y dlldata.i dlldata.i.c
# -- We can reformat dlldata.i.c to be more debugger friendly now, break *long* macro expanded lines etc. --
# -- Alternative: Use my stock 'dlldata.i.vc6sample.c' in place of 'dlldata.i.c'
cl /c /MTd /Zi /Od  /Fo"dlldata.i.obj"   dlldata.i.c
link /debug /dll /out:proxy.dll /def:proxy.def /map proxy.obj dlldata.i.obj guids.obj rpcrt4.lib

# Client.exe 
cl /c /MTd /Zi /Od /DWIN32 /D_DEBUG client.cpp util.cpp guids.c
link /debug client.obj util.obj guids.obj ole32.lib

### Be aware: These cpp generates different .obj files according to whether _OUTPROC_SERVER_ macro is defined:
### CFactory.cpp , utils.cpp , registry.cpp

# Server.exe
rc server.rc	
cl /c /MTd /Zi /Od /DWIN32 /D_DEBUG                    server.cpp cmpnt1.cpp cmpnt2.cpp cmpnt3.cpp
cl /c /MTd /Zi /Od /DWIN32 /D_DEBUG -D_OUTPROC_SERVER_ outproc.cpp CUnknown.cpp CFactory.cpp registry.cpp util.cpp guids.c
link /debug server.obj cmpnt1.obj cmpnt2.obj cmpnt3.obj CUnknown.obj CFactory.obj registry.obj util.obj outproc.obj guids.obj server.res ole32.lib user32.lib gdi32.lib advapi32.lib

